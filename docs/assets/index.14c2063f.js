import{d as b,r as se,o as i,c as d,a as n,w as P,t as _,F as w,b as D,n as C,e as M,f as I,g as ae,p as T,h as z,i as le,j as oe,k as O,l as L,m as j,u as h,q as y,s as ne,v as R,x as W,y as ue,z as X,A as x,B as re,C as J,D as q,E as ce,G as ie}from"./vendor.267d3537.js";const de=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function a(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerpolicy&&(l.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?l.credentials="include":s.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=a(s);fetch(s.href,l)}};de();var $=(e,t)=>{const a=e.__vccOpts||e;for(const[o,s]of t)a[o]=s;return a};const ve=e=>(T("data-v-6d47c5b5"),e=e(),z(),e),fe={class:"content"},pe={class:"cover"},_e={class:"name"},he={class:"artist"},me={class:"difficulties"},ge={class:"package"},ye={class:"categorys"},ke={key:0,class:"btn-group"},we=["onClick"],Ce=ve(()=>n("button",{class:"copy"},"Copy",-1)),Se=b({props:{data:null,selected:{type:Boolean},optEnable:{type:Boolean}},emits:["select-click"],setup(e,{emit:t}){const a=()=>{t("select-click")};return(o,s)=>{const l=se("lazy");return i(),d("div",{class:"music-item",style:ae({paddingBottom:e.optEnable?"30px":"0"})},[n("div",fe,[P(n("img",pe,null,512),[[l,`https://p.eagate.573.jp${e.data.cover}`]]),n("h3",_e,_(e.data.name),1),n("p",he,_(e.data.artist),1),n("div",me,[(i(!0),d(w,null,D(e.data.difficulties,u=>(i(),d("div",{key:u.id,class:C(["difficulty",u.name])},_(u.name)+" "+_(u.level),3))),128))]),n("p",ge,_(e.data.pacakge),1),n("div",ye,[(i(!0),d(w,null,D(e.data.category,u=>(i(),d("div",{key:u,class:C(["category",u])},_(u),3))),128))])]),e.optEnable?(i(),d("div",ke,[n("button",{class:C(["select",{selected:e.selected}]),onClick:M(a,["stop"])},"Select",10,we),Ce])):I("",!0)],4)}}});var be=$(Se,[["__scopeId","data-v-6d47c5b5"]]);const De=["onClick"],xe=b({props:{show:{type:Boolean,default:!1}},emits:["update:show"],setup(e,{emit:t}){const a=()=>{t("update:show",!1)};return(o,s)=>e.show?(i(),d("div",{key:0,class:"blur-bg",onClick:M(a,["stop"])},[n("div",{class:"float-panel",onClick:s[0]||(s[0]=M(()=>{},["stop"]))},[le(o.$slots,"default",{},void 0,!0)])],8,De)):I("",!0)}});var G=$(xe,[["__scopeId","data-v-3e06fdbf"]]);const Be=20220824;var H={version:Be};const K="x-sdvx-songdb",E=(e,t)=>e.localeCompare(t,"ja",{numeric:!0}),Q=e=>{try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}},Y=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},Fe=(e,t)=>{const a=new Set;if(e.length===0)return a;const o=new Set(e);for(let s of t)if(o.has(s.id)&&a.add(s),!o.size)break;return a},Pe=e=>{const t=e.filter(l=>l.startsWith("20")).sort(E),a=e.filter(l=>l.startsWith("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX \u697D\u66F2\u30D1\u30C3\u30AF")).sort(E),o=e.filter(l=>l==="\u6700\u521D\u304B\u3089\u30D7\u30EC\u30FC\u3067\u304D\u307E\u3059").sort(E),s=e.filter(l=>!l.startsWith("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX \u697D\u66F2\u30D1\u30C3\u30AF")&&!l.startsWith("20")&&l!=="\u6700\u521D\u304B\u3089\u30D7\u30EC\u30FC\u3067\u304D\u307E\u3059").sort(E);return[...o,...a,...t,...s]},Ie=async()=>{const e=localStorage.getItem(K);if(e){const o=JSON.parse(e);if(o.version>=H.version)return o.songs}const a=await(await fetch("./music_db.json?r="+new Date().valueOf())).json();return localStorage.setItem(K,JSON.stringify({version:H.version,songs:a.data})),a.data},Z=e=>e.startsWith("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX")?e.replace("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX",""):e,Oe=e=>{const t=new Map;for(const a of e){let o=t.get(a.pacakge);o===void 0&&(o=[],t.set(a.pacakge,o)),o.push(a)}return[...t]},$e=e=>{const t=new Map;return e.forEach(({pacakge:a})=>{const o=t.get(a);o!==void 0?t.set(a,o+1):t.set(a,1)}),t};const Ee=e=>(T("data-v-d2d65d62"),e=e(),z(),e),Me={class:"stat-panel"},Le={class:"stat-table"},Ne=Ee(()=>n("tr",null,[n("th",null,"Pack"),n("th",null,"Select/Total"),n("th",null,"Avg Diff")],-1)),Ve=b({props:{show:{default:!1,type:Boolean},data:{type:Array,default:[]}},setup(e){const t=e;let a=oe("packInfo");const o=O(()=>t.data.map(s=>{var k;const[l,u]=s,p=(k=a==null?void 0:a.value)==null?void 0:k.get(l),v=u.length,m=p!==void 0?v/p:0,g=u.reduce((B,S)=>B+S.difficulties.slice(-1)[0].level,0)/v;return{name:l,favCount:v,favPer:m,avgLevel:g}}).sort((s,l)=>s.favPer!==l.favPer?l.favPer-s.favPer:l.avgLevel-s.avgLevel));return(s,l)=>(i(),L(G,{show:e.show,"onUpdate:show":l[0]||(l[0]=u=>s.$emit("update:show",!1))},{default:j(()=>[n("div",Me,[n("table",Le,[Ne,(i(!0),d(w,null,D(h(o),u=>(i(),d("tr",{key:u.name},[n("td",null,_(h(Z)(u.name)),1),n("td",null,_(u.favPer.toFixed(3)),1),n("td",null,_(u.avgLevel.toFixed(3)),1)]))),128))])])]),_:1},8,["show"]))}});var Ae=$(Ve,[["__scopeId","data-v-d2d65d62"]]);const Ue={class:"filter-list"},Te=["value"],ze=q(" \uFF1F\uFF1F\uFF1F "),je={class:"search-bar"},Re={class:"setting-row"},We={class:"musics"},Xe={class:"total"},Je=b({setup(e){var A;let t=y(""),a=ne([]),o=y([]),s=y(0);const l=O(()=>$e(a)),u=O(()=>Pe([...l.value.keys()])),p=y((A=Q("filter"))!=null?A:[]),v=y(new Set);Ie().then(f=>{var r;a.push(...f),v.value=new Set(Fe((r=Q("selected-music"))!=null?r:[],a)),S()});let m=y(!1),g=y(!1);R("musics",a),R("packInfo",l),W(()=>{Y("filter",p.value)}),W(()=>{Y("selected-music",[...v.value].map(f=>f.id))});const k=O(()=>{if(!p.value.length)return a;const f=new Set(p.value);return a.filter(r=>f.has(r.pacakge))});let B;const S=()=>{clearTimeout(B),B=setTimeout(()=>{if(!t.value.trim())s.value=k.value.length,p.value.length?o.value=k.value:o.value=k.value.slice(0,200);else{const f=new ue(k.value,{keys:["name","artist"]});o.value=f.search(t.value).map(r=>r.item),s.value=o.value.length}},200)},F=y(!1),N=y(!1);let V=0;const ee=()=>{V++,V>5&&(N.value=!0)},te=f=>{v.value.has(f)?v.value.delete(f):v.value.add(f)};return(f,r)=>(i(),d(w,null,[n("h1",{onClick:ee},"\u30B3\u30CA\u30B9\u30C6\u7248 SDVXEG \u697D\u66F2\u691C\u7D22"),X(G,{show:h(m),"onUpdate:show":r[2]||(r[2]=c=>x(m)?m.value=c:m=c)},{default:j(()=>[n("div",Ue,[(i(!0),d(w,null,D(h(u),c=>(i(),d("label",{class:C(["package",{active:p.value.indexOf(c)!==-1}])},[P(n("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":r[0]||(r[0]=U=>p.value=U),value:c,onInput:S},null,40,Te),[[J,p.value]]),q(" "+_(h(Z)(c)),1)],2))),256)),N.value?(i(),d("label",{key:0,class:C(["package",{active:F.value}])},[P(n("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":r[1]||(r[1]=c=>F.value=c)},null,512),[[J,F.value]]),ze],2)):I("",!0)])]),_:1},8,["show"]),X(Ae,{show:h(g),"onUpdate:show":r[3]||(r[3]=c=>x(g)?g.value=c:g=c),data:h(Oe)([...v.value])},null,8,["show","data"]),n("div",je,[P(n("input",{type:"text","onUpdate:modelValue":r[4]||(r[4]=c=>x(t)?t.value=c:t=c),onInput:S,placeholder:"keyword...",class:"keyword"},null,544),[[re,h(t)]]),n("div",Re,[n("button",{class:C(["filter",{active:p.value.length}]),onClick:r[5]||(r[5]=c=>x(m)?m.value=!0:m=!0)},"filter",2),v.value.size?(i(),d("button",{key:0,class:"filter",onClick:r[6]||(r[6]=c=>x(g)?g.value=!0:g=!0)},"stat")):I("",!0)])]),n("div",We,[n("p",Xe,"total "+_(h(s))+" songs",1),(i(!0),d(w,null,D(h(o),c=>(i(),L(be,{key:c.id,data:c,selected:v.value.has(c),"opt-enable":F.value,onSelectClick:U=>te(c)},null,8,["data","selected","opt-enable","onSelectClick"]))),128))])],64))}});var qe=$(Je,[["__scopeId","data-v-db474624"]]);const Ge=b({setup(e){return(t,a)=>(i(),L(qe))}});ce(Ge).use(ie,{error:"",loading:""}).mount("#app");
