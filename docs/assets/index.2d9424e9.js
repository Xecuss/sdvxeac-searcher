import{d as D,r as te,o as i,c as d,a as u,w as F,t as _,F as k,b as x,n as w,e as $,f as P,g as se,p as U,h as T,i as ae,j as le,k as I,l as M,m as z,u as m,q as g,s as oe,v as j,x as W,y as ne,z as X,A as B,B as ue,C as J,D as R,E as re,G as ce}from"./vendor.267d3537.js";const ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function s(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerpolicy&&(l.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?l.credentials="include":a.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(a){if(a.ep)return;a.ep=!0;const l=s(a);fetch(a.href,l)}};ie();var O=(e,t)=>{const s=e.__vccOpts||e;for(const[o,a]of t)s[o]=a;return s};const de=e=>(U("data-v-6d47c5b5"),e=e(),T(),e),ve={class:"content"},fe={class:"cover"},pe={class:"name"},_e={class:"artist"},he={class:"difficulties"},me={class:"package"},ge={class:"categorys"},ye={key:0,class:"btn-group"},ke=["onClick"],we=de(()=>u("button",{class:"copy"},"Copy",-1)),Ce=D({props:{data:null,selected:{type:Boolean},optEnable:{type:Boolean}},emits:["select-click"],setup(e,{emit:t}){const s=()=>{t("select-click")};return(o,a)=>{const l=te("lazy");return i(),d("div",{class:"music-item",style:se({paddingBottom:e.optEnable?"30px":"0"})},[u("div",ve,[F(u("img",fe,null,512),[[l,`https://p.eagate.573.jp${e.data.cover}`]]),u("h3",pe,_(e.data.name),1),u("p",_e,_(e.data.artist),1),u("div",he,[(i(!0),d(k,null,x(e.data.difficulties,n=>(i(),d("div",{key:n.id,class:w(["difficulty",n.name])},_(n.name)+" "+_(n.level),3))),128))]),u("p",me,_(e.data.pacakge),1),u("div",ge,[(i(!0),d(k,null,x(e.data.category,n=>(i(),d("div",{key:n,class:w(["category",n])},_(n),3))),128))])]),e.optEnable?(i(),d("div",ye,[u("button",{class:w(["select",{selected:e.selected}]),onClick:$(s,["stop"])},"Select",10,ke),we])):P("",!0)],4)}}});var Se=O(Ce,[["__scopeId","data-v-6d47c5b5"]]);const be=["onClick"],De=D({props:{show:{type:Boolean,default:!1}},emits:["update:show"],setup(e,{emit:t}){const s=()=>{t("update:show",!1)};return(o,a)=>e.show?(i(),d("div",{key:0,class:"blur-bg",onClick:$(s,["stop"])},[u("div",{class:"float-panel",onClick:a[0]||(a[0]=$(()=>{},["stop"]))},[ae(o.$slots,"default",{},void 0,!0)])],8,be)):P("",!0)}});var q=O(De,[["__scopeId","data-v-3e06fdbf"]]);const xe=20220604;var G={version:xe};const H="x-sdvx-songdb",E=(e,t)=>e.localeCompare(t,"ja",{numeric:!0}),K=e=>{try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}},Q=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},Be=(e,t)=>{const s=new Set;if(e.length===0)return s;const o=new Set(e);for(let a of t)if(o.has(a.id)&&s.add(a),!o.size)break;return s},Fe=e=>{const t=e.filter(l=>l.startsWith("20")).sort(E),s=e.filter(l=>l.startsWith("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX \u697D\u66F2\u30D1\u30C3\u30AF")).sort(E),o=e.filter(l=>l==="\u6700\u521D\u304B\u3089\u30D7\u30EC\u30FC\u3067\u304D\u307E\u3059").sort(E),a=e.filter(l=>!l.startsWith("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX \u697D\u66F2\u30D1\u30C3\u30AF")&&!l.startsWith("20")&&l!=="\u6700\u521D\u304B\u3089\u30D7\u30EC\u30FC\u3067\u304D\u307E\u3059").sort(E);return[...o,...s,...t,...a]},Pe=async()=>{const e=localStorage.getItem(H);if(e){const o=JSON.parse(e);if(o.version>=G.version)return o.songs}const s=await(await fetch("./music_db.json?r="+new Date().valueOf())).json();return localStorage.setItem(H,JSON.stringify({version:G.version,songs:s.data})),s.data},Y=e=>e.startsWith("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX")?e.replace("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX",""):e,Ie=e=>{const t=new Map;for(const s of e){let o=t.get(s.pacakge);o===void 0&&(o=[],t.set(s.pacakge,o)),o.push(s)}return[...t]},Oe=e=>{const t=new Map;return e.forEach(({pacakge:s})=>{const o=t.get(s);o!==void 0?t.set(s,o+1):t.set(s,1)}),t};const Ee=e=>(U("data-v-d2d65d62"),e=e(),T(),e),$e={class:"stat-panel"},Me={class:"stat-table"},Le=Ee(()=>u("tr",null,[u("th",null,"Pack"),u("th",null,"Select/Total"),u("th",null,"Avg Diff")],-1)),Ne=D({props:{show:{default:!1,type:Boolean},data:{type:Array,default:[]}},setup(e){const t=e;let s=le("packInfo");const o=I(()=>t.data.map(a=>{var S;const[l,n]=a,f=(S=s==null?void 0:s.value)==null?void 0:S.get(l),p=n.length,h=f!==void 0?p/f:0,C=n.reduce((b,y)=>b+y.difficulties.slice(-1)[0].level,0)/p;return{name:l,favCount:p,favPer:h,avgLevel:C}}).sort((a,l)=>a.favPer!==l.favPer?l.favPer-a.favPer:l.avgLevel-a.avgLevel));return(a,l)=>(i(),M(q,{show:e.show,"onUpdate:show":l[0]||(l[0]=n=>a.$emit("update:show",!1))},{default:z(()=>[u("div",$e,[u("table",Me,[Le,(i(!0),d(k,null,x(m(o),n=>(i(),d("tr",{key:n.name},[u("td",null,_(m(Y)(n.name)),1),u("td",null,_(n.favPer.toFixed(3)),1),u("td",null,_(n.avgLevel.toFixed(3)),1)]))),128))])])]),_:1},8,["show"]))}});var Ve=O(Ne,[["__scopeId","data-v-d2d65d62"]]);const Ae={class:"filter-list"},Ue=["value"],Te=R(" \uFF1F\uFF1F\uFF1F "),ze={class:"search-bar"},je={class:"setting-row"},We={class:"musics"},Xe=D({setup(e){var V;let t=g(""),s=oe([]),o=g([]);const a=I(()=>Oe(s)),l=I(()=>Fe([...a.value.keys()])),n=g((V=K("filter"))!=null?V:[]),f=g(new Set);Pe().then(v=>{var r;s.push(...v),f.value=new Set(Be((r=K("selected-music"))!=null?r:[],s)),b()});let p=g(!1),h=g(!1);j("musics",s),j("packInfo",a),W(()=>{Q("filter",n.value)}),W(()=>{Q("selected-music",[...f.value].map(v=>v.id))});const C=I(()=>{if(!n.value.length)return s;const v=new Set(n.value);return s.filter(r=>v.has(r.pacakge))});let S;const b=()=>{clearTimeout(S),S=setTimeout(()=>{if(!t.value.trim())n.value.length?o.value=C.value:o.value=C.value.slice(0,200);else{const v=new ne(C.value,{keys:["name","artist"]});o.value=v.search(t.value).map(r=>r.item)}},200)},y=g(!1),L=g(!1);let N=0;const Z=()=>{N++,N>5&&(L.value=!0)},ee=v=>{f.value.has(v)?f.value.delete(v):f.value.add(v)};return(v,r)=>(i(),d(k,null,[u("h1",{onClick:Z},"\u30B3\u30CA\u30B9\u30C6\u7248 SDVXEG \u4E50\u66F2\u691C\u7D22"),X(q,{show:m(p),"onUpdate:show":r[2]||(r[2]=c=>B(p)?p.value=c:p=c)},{default:z(()=>[u("div",Ae,[(i(!0),d(k,null,x(m(l),c=>(i(),d("label",{class:w(["package",{active:n.value.indexOf(c)!==-1}])},[F(u("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":r[0]||(r[0]=A=>n.value=A),value:c,onInput:b},null,40,Ue),[[J,n.value]]),R(" "+_(m(Y)(c)),1)],2))),256)),L.value?(i(),d("label",{key:0,class:w(["package",{active:y.value}])},[F(u("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":r[1]||(r[1]=c=>y.value=c)},null,512),[[J,y.value]]),Te],2)):P("",!0)])]),_:1},8,["show"]),X(Ve,{show:m(h),"onUpdate:show":r[3]||(r[3]=c=>B(h)?h.value=c:h=c),data:m(Ie)([...f.value])},null,8,["show","data"]),u("div",ze,[F(u("input",{type:"text","onUpdate:modelValue":r[4]||(r[4]=c=>B(t)?t.value=c:t=c),onInput:b,placeholder:"keyword...",class:"keyword"},null,544),[[ue,m(t)]]),u("div",je,[u("button",{class:w(["filter",{active:n.value.length}]),onClick:r[5]||(r[5]=c=>B(p)?p.value=!0:p=!0)},"filter",2),f.value.size?(i(),d("button",{key:0,class:"filter",onClick:r[6]||(r[6]=c=>B(h)?h.value=!0:h=!0)},"stat")):P("",!0)])]),u("div",We,[(i(!0),d(k,null,x(m(o),c=>(i(),M(Se,{key:c.id,data:c,selected:f.value.has(c),"opt-enable":y.value,onSelectClick:A=>ee(c)},null,8,["data","selected","opt-enable","onSelectClick"]))),128))])],64))}});var Je=O(Xe,[["__scopeId","data-v-27f368be"]]);const Re=D({setup(e){return(t,s)=>(i(),M(Je))}});re(Re).use(ce,{error:"",loading:""}).mount("#app");
