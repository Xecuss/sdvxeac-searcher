import{d as S,r as se,o as i,c as v,a as u,w as M,t as f,F as k,b,n as w,e as V,f as P,g as ae,p as j,h as H,i as le,j as oe,k as I,l as A,m as R,u as d,q as _,s as W,v as ne,x as X,y as ue,z as J,A as D,B as re,C as q,D as G,E as ce,G as ie}from"./vendor.25022800.js";const de=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}};de();var O=(e,t)=>{const s=e.__vccOpts||e;for(const[o,l]of t)s[o]=l;return s};const ve=e=>(j("data-v-1a6721a2"),e=e(),H(),e),pe={class:"content"},fe={class:"cover"},_e={class:"name"},he={class:"artist"},me={class:"difficulties"},ge={class:"package"},ye={class:"categorys"},ke={key:0,class:"btn-group"},we=["onClick"],Ce=ve(()=>u("button",{class:"copy"},"Copy",-1)),Se=S({props:{data:null,selected:{type:Boolean},optEnable:{type:Boolean}},emits:["select-click"],setup(e,{emit:t}){const s=()=>{t("select-click")};return(o,l)=>{const a=se("lazy");return i(),v("div",{class:"music-item",style:ae({paddingBottom:e.optEnable?"30px":"0"})},[u("div",pe,[M(u("img",fe,null,512),[[a,`https://p.eagate.573.jp${e.data.cover}`]]),u("h3",_e,f(e.data.name),1),u("p",he,f(e.data.artist),1),u("div",me,[(i(!0),v(k,null,b(e.data.difficulties,n=>(i(),v("div",{key:n.id,class:w(["difficulty",n.name])},f(n.name)+" "+f(n.level),3))),128))]),u("p",ge,f(e.data.pacakge),1),u("div",ye,[(i(!0),v(k,null,b(e.data.category,n=>(i(),v("div",{key:n,class:w(["category",n])},f(n),3))),128))])]),e.optEnable?(i(),v("div",ke,[u("button",{class:w(["select",{selected:e.selected}]),onClick:V(s,["stop"])},"Select",10,we),Ce])):P("",!0)],4)}}});var be=O(Se,[["__scopeId","data-v-1a6721a2"]]);const De=["onClick"],xe=S({props:{show:{type:Boolean,default:!1}},emits:["update:show"],setup(e,{emit:t}){const s=()=>{t("update:show",!1)};return(o,l)=>e.show?(i(),v("div",{key:0,class:"blur-bg",onClick:V(s,["stop"])},[u("div",{class:"float-panel",onClick:l[0]||(l[0]=V(()=>{},["stop"]))},[le(o.$slots,"default",{},void 0,!0)])],8,De)):P("",!0)}});var K=O(xe,[["__scopeId","data-v-14c47cdc"]]);const Be=20221226;var Q={version:Be};const Y="x-sdvx-songdb",$=(e,t)=>e.localeCompare(t,"ja",{numeric:!0}),Z=e=>{try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}},ee=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},Fe=(e,t)=>{const s=new Set;if(e.length===0)return s;const o=new Set(e);for(let l of t)if(o.has(l.id)&&s.add(l),!o.size)break;return s},Me=e=>{const t=e.filter(a=>a.startsWith("20")).sort($),s=e.filter(a=>a.startsWith("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX \u697D\u66F2\u30D1\u30C3\u30AF")).sort($),o=e.filter(a=>a==="\u6700\u521D\u304B\u3089\u30D7\u30EC\u30FC\u3067\u304D\u307E\u3059").sort($),l=e.filter(a=>!a.startsWith("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX \u697D\u66F2\u30D1\u30C3\u30AF")&&!a.startsWith("20")&&a!=="\u6700\u521D\u304B\u3089\u30D7\u30EC\u30FC\u3067\u304D\u307E\u3059").sort($);return[...o,...s,...t,...l]},Pe=async()=>{const e=localStorage.getItem(Y);if(e){const o=JSON.parse(e);if(o.version>=Q.version)return o.songs}const s=await(await fetch("./music_db.json?r="+new Date().valueOf())).json();return localStorage.setItem(Y,JSON.stringify({version:Q.version,songs:s.data})),s.data},te=e=>e.startsWith("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX")?e.replace("\u30B3\u30CA\u30B9\u30C6\u7248 SOUND VOLTEX",""):e,Ie=e=>{const t=new Map;for(const s of e){let o=t.get(s.pacakge);o===void 0&&(o=[],t.set(s.pacakge,o)),o.push(s)}return[...t]},Oe=e=>{const t=new Map;return e.forEach(({pacakge:s})=>{const o=t.get(s);o!==void 0?t.set(s,o+1):t.set(s,1)}),t};const $e=e=>(j("data-v-5d8744eb"),e=e(),H(),e),Ee={class:"stat-panel"},Le={class:"stat-table"},Ne=$e(()=>u("tr",null,[u("th",null,"Pack"),u("th",null,"Select/Total"),u("th",null,"Avg Diff")],-1)),Ve=S({props:{show:{default:!1,type:Boolean},data:{type:Array,default:[]}},setup(e){const t=e;let s=oe("packInfo");const o=I(()=>t.data.map(l=>{var x;const[a,n]=l,h=(x=s==null?void 0:s.value)==null?void 0:x.get(a),p=n.length,C=h!==void 0?p/h:0,E=n.reduce((L,B)=>L+B.difficulties.slice(-1)[0].level,0)/p;return{name:a,favCount:p,favPer:C,avgLevel:E}}).sort((l,a)=>l.favPer!==a.favPer?a.favPer-l.favPer:a.avgLevel-l.avgLevel));return(l,a)=>(i(),A(K,{show:e.show,"onUpdate:show":a[0]||(a[0]=n=>l.$emit("update:show",!1))},{default:R(()=>[u("div",Ee,[u("table",Le,[Ne,(i(!0),v(k,null,b(d(o),n=>(i(),v("tr",{key:n.name},[u("td",null,f(d(te)(n.name)),1),u("td",null,f(n.favPer.toFixed(3)),1),u("td",null,f(n.avgLevel.toFixed(3)),1)]))),128))])])]),_:1},8,["show"]))}});var Ae=O(Ve,[["__scopeId","data-v-5d8744eb"]]);function Ue(){const e=_(new Set),t=n=>{var h;e.value=new Set(Fe((h=Z("selected-music"))!=null?h:[],n)),W(()=>{ee("selected-music",[...e.value].map(p=>p.id))})},s=_(!1);let o=0;return{selectedMusic:e,initSelectedMusic:t,displayHidden:s,titleClickHandle:()=>{o++,o>5&&(s.value=!0)},selectMusic:n=>{e.value.has(n)?e.value.delete(n):e.value.add(n)}}}const Te={class:"filter-list"},ze=["value"],je=G(" \uFF1F\uFF1F\uFF1F "),He={class:"search-bar"},Re={class:"setting-row"},We={class:"total"},Xe={class:"musics"},Je=S({setup(e){var T;let t=_(""),s=ne([]),o=_([]),l=_(0);const a=_(!1),n=I(()=>Oe(s)),h=I(()=>Me([...n.value.keys()])),p=_((T=Z("filter"))!=null?T:[]),{selectedMusic:C,selectMusic:E,initSelectedMusic:x,displayHidden:L,titleClickHandle:B}=Ue();Pe().then(y=>{s.push(...y),x(s),N()});let m=_(!1),g=_(!1);X("musics",s),X("packInfo",n),W(()=>{ee("filter",p.value)});const F=I(()=>{if(!p.value.length)return s;const y=new Set(p.value);return s.filter(c=>y.has(c.pacakge))});let U;const N=()=>{clearTimeout(U),U=setTimeout(()=>{if(!t.value.trim())l.value=F.value.length,p.value.length?o.value=F.value:o.value=F.value.slice(0,200);else{const y=new ue(F.value,{keys:["name","artist"]});o.value=y.search(t.value).map(c=>c.item),l.value=o.value.length}},200)};return(y,c)=>(i(),v(k,null,[u("h1",{onClick:c[0]||(c[0]=(...r)=>d(B)&&d(B)(...r))},"\u30B3\u30CA\u30B9\u30C6\u7248 SDVXEG \u697D\u66F2\u691C\u7D22"),J(K,{show:d(m),"onUpdate:show":c[3]||(c[3]=r=>D(m)?m.value=r:m=r)},{default:R(()=>[u("div",Te,[(i(!0),v(k,null,b(d(h),r=>(i(),v("label",{class:w(["package",{active:p.value.indexOf(r)!==-1}])},[M(u("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":c[1]||(c[1]=z=>p.value=z),value:r,onInput:N},null,40,ze),[[q,p.value]]),G(" "+f(d(te)(r)),1)],2))),256)),d(L)?(i(),v("label",{key:0,class:w(["package",{active:a.value}])},[M(u("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":c[2]||(c[2]=r=>a.value=r)},null,512),[[q,a.value]]),je],2)):P("",!0)])]),_:1},8,["show"]),J(Ae,{show:d(g),"onUpdate:show":c[4]||(c[4]=r=>D(g)?g.value=r:g=r),data:d(Ie)([...d(C)])},null,8,["show","data"]),u("div",He,[M(u("input",{type:"text","onUpdate:modelValue":c[5]||(c[5]=r=>D(t)?t.value=r:t=r),onInput:N,placeholder:"keyword...",class:"keyword"},null,544),[[re,d(t)]]),u("div",Re,[u("button",{class:w(["filter",{active:p.value.length}]),onClick:c[6]||(c[6]=r=>D(m)?m.value=!0:m=!0)},"filter",2),d(C).size&&a.value?(i(),v("button",{key:0,class:"filter",onClick:c[7]||(c[7]=r=>D(g)?g.value=!0:g=!0)},"stat")):P("",!0)])]),u("p",We,"total "+f(d(l))+" songs",1),u("div",Xe,[(i(!0),v(k,null,b(d(o),r=>(i(),A(be,{key:r.id,data:r,selected:d(C).has(r),"opt-enable":a.value,onSelectClick:z=>d(E)(r)},null,8,["data","selected","opt-enable","onSelectClick"]))),128))])],64))}});var qe=O(Je,[["__scopeId","data-v-c09a85a4"]]);const Ge=S({setup(e){return(t,s)=>(i(),A(qe))}});ce(Ge).use(ie,{error:"",loading:""}).mount("#app");
